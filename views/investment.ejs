<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elite Investment Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
body{margin:0;background:#0d0d0d;color:white;font-family:Poppins;}
.container{width:95%;max-width:1200px;margin:40px auto;}
h1,h2{color:gold;text-align:center;}
.plan-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-top:30px;}
.plan-card{background:#151515;padding:20px;border-radius:15px;box-shadow:0 0 25px rgba(255,215,0,0.2);text-align:center;transition:transform 0.3s;}
.plan-card:hover{transform:scale(1.05);}
.plan-card h3{color:#FFD700;margin-bottom:10px;}
.plan-card p{margin:6px 0;}
.plan-card input{width:90%;margin:5px 0;padding:8px;border-radius:6px;border:none;background:#0d0d0d;color:white;}
.plan-card button{margin-top:10px;padding:10px 20px;background:gold;border:none;border-radius:10px;cursor:pointer;font-weight:bold;}
.plan-card button:hover{background:#e6c200;}
.card{background:#151515;padding:25px;border-radius:15px;box-shadow:0 0 25px rgba(255,215,0,0.2);margin-bottom:25px;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{padding:12px;text-align:left;}
th{background:black;color:gold;}
tr:nth-child(even){background:#1c1c1c;}
.status{margin-top:15px;padding:10px;border-radius:8px;text-align:center;display:none;}
.success{background:green;color:white;}
.error{background:red;color:white;}
button.move-profit{background:#008000;margin-top:5px;}
button.move-profit:hover{background:#00b300;}
/* Footer support */
.support {
  position: fixed;
  bottom: 0;
  width: 100%;
  background: #111;
  padding: 10px 0;
  text-align: center;
  font-size: 16px;
  border-top: 1px solid gold;
  color: white;
  z-index: 100;
}
.support a {
  color: gold;
  text-decoration: none;
  margin: 0 10px;
}
</style>
</head>
<body>

<div class="container">
<h1>Elite Investment Dashboard</h1>
<p style="text-align:center;font-size:18px;">Available Balance: $<span id="balance"><%= user.balance || 0 %></span></p>

<div class="plan-grid">
  <% const plans = [
    {name:"Starter", min:5000, max:10000, roi:3.75, wait:10},
    {name:"Growth", min:10100, max:49900, roi:4.2, wait:15},
    {name:"Wealth", min:50000, max:200000, roi:5.8, wait:30},
    {name:"Elite Premium", min:200000, max:Infinity, roi:7.5, wait:30}
  ]; %>

  <% plans.forEach(plan => { %>
    <div class="plan-card" data-plan="<%= plan.name %>">
      <h3><%= plan.name %></h3>
      <p>Investment: $<%= plan.min %> - <%= plan.max===Infinity ? '+' : '$'+plan.max %></p>
      <p>ROI: <%= plan.roi %>%</p>
      <p>Wait: <%= plan.wait %> day(s)</p>
      <input type="number" placeholder="Amount ($)" class="plan-amount">
      <button onclick="investPlan('<%= plan.name %>', this)">Invest</button>
    </div>
  <% }) %>
</div>

<div class="card">
<h2>My Investments & Profits</h2>
<table>
<thead>
<tr><th>Plan</th><th>Amount</th><th>Profit</th><th>Withdrawable</th><th>Date</th><th>Action</th></tr>
</thead>
<tbody id="investments">
  <% investments.forEach(inv => { %>
    <tr>
      <td><%= inv.plan || 'N/A' %></td>
      <td>$<%= (inv.amount || 0).toFixed(2) %></td>
      <td>$<%= (inv.profit || 0).toFixed(2) %></td>
      <td>$<%= (inv.withdrawable || 0).toFixed(2) %></td>
      <td><%= inv.created_at ? new Date(inv.created_at).toDateString() : 'N/A' %></td>
      <td>
        <% if((inv.withdrawable || 0)===0 && inv.status!=='Moved'){ %>
          <button class="move-profit" onclick="moveProfit(<%= inv.id %>, this)">Move Profit</button>
        <% } else { %>
          <span><%= inv.status==='Moved' ? 'Profit Moved' : 'Waiting...' %></span>
        <% } %>
      </td>
    </tr>
  <% }) %>
</tbody>
</table>
</div>

<div class="status" id="statusBox"></div>
</div>

<!-- Footer support -->
<div class="support">
  Need help? Contact us: 
  <a href="https://t.me/Afoundationservicecenter" target="_blank">Telegram</a> |
  <a href="mailto:Agriculturalfoundationdeposits@gmail.com">Gmail</a>
</div>

<script>
// Invest plan
function investPlan(plan, btn){
  const card = btn.parentElement;
  const amount = parseFloat(card.querySelector(".plan-amount").value);
  if(!amount){ alert("Enter amount"); return; }

  fetch("/invest",{
    method:"POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({plan, amount})
  })
  .then(res=>res.json())
  .then(data=>{
    const statusBox = document.getElementById("statusBox");
    statusBox.style.display="block";
    if(data.success){
      statusBox.className="status success";
      statusBox.innerText = data.message;
      document.getElementById("balance").innerText = data.newBalance.toFixed(2);
      setTimeout(()=>location.reload(),2000);
    } else {
      statusBox.className="status error";
      statusBox.innerText = data.message;
    }
  })
  .catch(err=>{
    const statusBox = document.getElementById("statusBox");
    statusBox.style.display="block";
    statusBox.className="status error";
    statusBox.innerText = "Server error!";
  });
}

// Move profit
function moveProfit(investmentId, btn){
  fetch("/invest/move-profit",{
    method:"POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({investmentId})
  })
  .then(res=>res.json())
  .then(data=>{
    const statusBox = document.getElementById("statusBox");
    statusBox.style.display="block";
    if(data.success){
      statusBox.className="status success";
      statusBox.innerText = data.message;
      document.getElementById("balance").innerText = data.newBalance.toFixed(2);
      setTimeout(()=>location.reload(),1500);
    } else {
      statusBox.className="status error";
      statusBox.innerText = data.message;
    }
  })
  .catch(err=>{
    const statusBox = document.getElementById("statusBox");
    statusBox.style.display="block";
    statusBox.className="status error";
    statusBox.innerText = "Server error!";
  });
}
</script>

</body>
</html>